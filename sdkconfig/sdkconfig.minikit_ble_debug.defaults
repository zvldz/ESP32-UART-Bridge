# MINIKIT BLE DEBUG (ESP32-WROOM-32 with NimBLE)
# BASE
CONFIG_AUTOSTART_ARDUINO=y
CONFIG_FREERTOS_UNICORE=n
CONFIG_FREERTOS_HZ=1000

# IRAM optimization
CONFIG_FREERTOS_PLACE_FUNCTIONS_INTO_FLASH=y

# NO TinyUSB (WROOM has no USB peripheral)
CONFIG_TINYUSB_ENABLED=n

# NO PSRAM (WROOM has none)
CONFIG_SPIRAM=n

# Flash
CONFIG_ESPTOOLPY_FLASHSIZE="4MB"
CONFIG_ESPTOOLPY_FLASHSIZE_4MB=y

# Debug logs
CONFIG_LOG_DEFAULT_LEVEL_WARN=y
CONFIG_LOG_DEFAULT_LEVEL=2

# Bootloader
CONFIG_BOOTLOADER_LOG_LEVEL_NONE=y
CONFIG_BOOTLOADER_LOG_LEVEL=0
CONFIG_BOOT_ROM_LOG_ALWAYS_OFF=y

# Core Dump to Flash
CONFIG_ESP_COREDUMP_TO_FLASH_OR_UART=y
CONFIG_ESP_COREDUMP_ENABLE_TO_FLASH=y
CONFIG_ESP_COREDUMP_DATA_FORMAT_ELF=y
CONFIG_ESP_COREDUMP_CHECKSUM_CRC32=y
CONFIG_ESP_COREDUMP_MAX_TASKS_NUM=64

# UART DMA support
CONFIG_UART_ISR_IN_IRAM=y

# System event task stack (default 2304 is too small with log_msg stack buffers)
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=3072

# WiFi (disabled when BLE active, enabled for temp AP)
CONFIG_ESP32_WIFI_ENABLED=y
CONFIG_ESP32_WIFI_STATIC_RX_BUFFER_NUM=10
CONFIG_ESP32_WIFI_DYNAMIC_RX_BUFFER_NUM=16
CONFIG_ESP32_WIFI_STATIC_TX_BUFFER_NUM=8
CONFIG_ESP32_WIFI_DYNAMIC_TX_BUFFER_NUM=8
CONFIG_ESP32_WIFI_RX_BUFFER_TYPE=2
CONFIG_ESP32_WIFI_TX_BUFFER_TYPE=2
CONFIG_ESP_WIFI_STA_SLEEP_ENABLE=n
CONFIG_ESP32_WIFI_PS_NONE=y
CONFIG_ESP32_WIFI_PS_MIN_MODEM=n
CONFIG_ESP32_WIFI_PS_MAX_MODEM=n
CONFIG_ESP32_WIFI_AMPDU_TX_ENABLED=y
CONFIG_ESP32_WIFI_AMPDU_RX_ENABLED=y
CONFIG_ESP32_WIFI_RX_BA_WIN=16
CONFIG_ESP32_WIFI_IRAM_OPT=y
CONFIG_ESP32_WIFI_RX_IRAM_OPT=y

# UART Driver
CONFIG_UART_ENABLED=y

# GPIO Driver
CONFIG_GPIO_ENABLED=y

# Timer Driver
CONFIG_TIMER_ENABLED=y

# SPI Master (for flash)
CONFIG_SPI_MASTER_ENABLED=y

# mDNS
CONFIG_MDNS_ENABLED=y
CONFIG_MDNS_TASK_PRIORITY=5

# LWIP - TCP optimized for low memory
CONFIG_LWIP_IPV6=n
CONFIG_LWIP_IPV6_NUM_ADDRESSES=0
CONFIG_LWIP_MLDV6_TMR_INTERVAL=0
CONFIG_LWIP_MAX_SOCKETS=6
CONFIG_LWIP_MAX_ACTIVE_TCP=4
CONFIG_LWIP_MAX_LISTENING_TCP=2
CONFIG_LWIP_TCP_SND_BUF_DEFAULT=1460
CONFIG_LWIP_TCP_WND_DEFAULT=1460
CONFIG_LWIP_TCPIP_RECVMBOX_SIZE=16

# LittleFS
CONFIG_LITTLEFS_ENABLED=y

# Compiler
CONFIG_COMPILER_OPTIMIZATION_PERF=y

# Disable unused features
CONFIG_ETH_ENABLED=n
CONFIG_IDF_COMPONENT_MANAGER=n
CONFIG_OPENSSL_ASSERT_DO_NOTHING=y
CONFIG_ZB_ENABLED=n
CONFIG_OPENTHREAD_ENABLED=n
CONFIG_IEEE802154_ENABLED=n

# mbedTLS required for WiFi WPA2
CONFIG_MBEDTLS_ENABLED=y

# BLE using ESP-IDF NimBLE (lightweight BLE stack)
CONFIG_BT_ENABLED=y
CONFIG_BT_NIMBLE_ENABLED=y
CONFIG_BLUEDROID_ENABLED=n
# NimBLE configuration - peripheral only
CONFIG_BT_NIMBLE_ROLE_PERIPHERAL=y
CONFIG_BT_NIMBLE_ROLE_CENTRAL=n
CONFIG_BT_NIMBLE_ROLE_BROADCASTER=y
CONFIG_BT_NIMBLE_ROLE_OBSERVER=n
# BLE connection settings
CONFIG_BT_NIMBLE_MAX_CONNECTIONS=1
CONFIG_BT_NIMBLE_MAX_BONDS=10
CONFIG_BT_NIMBLE_NVS_PERSIST=y
CONFIG_BT_NIMBLE_MAX_CCCDS=8
CONFIG_BT_NIMBLE_L2CAP_COC_MAX_NUM=0
# Buffer sizes (optimized for NUS)
CONFIG_BT_NIMBLE_ATT_PREFERRED_MTU=256
CONFIG_BT_NIMBLE_ACL_BUF_COUNT=12
CONFIG_BT_NIMBLE_ACL_BUF_SIZE=255
CONFIG_BT_NIMBLE_HCI_EVT_BUF_SIZE=70
CONFIG_BT_NIMBLE_HCI_EVT_HI_BUF_COUNT=8
CONFIG_BT_NIMBLE_HCI_EVT_LO_BUF_COUNT=8
# GAP settings
CONFIG_BT_NIMBLE_SVC_GAP_DEVICE_NAME="ESP-Bridge"
CONFIG_BT_NIMBLE_GAP_DEVICE_NAME_MAX_LEN=31
CONFIG_BT_NIMBLE_SVC_GAP_APPEARANCE=0
CONFIG_BT_NIMBLE_GATT_MAX_PROCS=4
# Disable extended advertising (BLE 5.0 feature)
CONFIG_BT_NIMBLE_EXT_ADV=n
# Memory allocation - internal only (no PSRAM on MiniKit)
CONFIG_BT_NIMBLE_MEM_ALLOC_MODE_INTERNAL=y
# Task stack size
CONFIG_BT_NIMBLE_TASK_STACK_SIZE=4096
# Core pinning - BLE on Core 1
CONFIG_BT_NIMBLE_PINNED_TO_CORE_1=y
# Security - Just Works pairing with bonding
CONFIG_BT_NIMBLE_SM_LEGACY=y
CONFIG_BT_NIMBLE_SM_SC=y
# Debug logging for BLE
CONFIG_BT_NIMBLE_LOG_LEVEL_WARNING=y

# WiFi + BLE Coexistence
CONFIG_ESP_COEX_SW_COEXIST_ENABLE=y

# Controller mode: BLE only (ESP32 dual-mode controller)
CONFIG_BTDM_CTRL_MODE_BLE_ONLY=y
CONFIG_BTDM_CTRL_MODE_BR_EDR_ONLY=n
CONFIG_BTDM_CTRL_MODE_BTDM=n

# Disable security features
CONFIG_SECURE_FLASH_ENC_ENABLED=n
CONFIG_SECURE_BOOT=n
CONFIG_SECURE_BOOT_SIGNED_BINARIES=n
CONFIG_SECURE_BOOT_BUILD_SIGNED_BINARIES=n

# Disable unused file systems
CONFIG_SPIFFS_ENABLED=n
CONFIG_FATFS_ENABLED=n

# Disable unused protocols
CONFIG_ESP_HTTP_CLIENT_ENABLE=n
CONFIG_ESP_HTTP_SERVER_ENABLE=n
CONFIG_ESP_WEBSOCKET_CLIENT_ENABLE=n
CONFIG_MQTT_ENABLED=n
CONFIG_COAP_ENABLED=n
